(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44047,       1219]
NotebookOptionsPosition[     39029,       1123]
NotebookOutlinePosition[     39462,       1140]
CellTagsIndexPosition[     39419,       1137]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["Computing ", "Section"],
 StyleBox[Cell[BoxData[
  FormBox[
   RowBox[{"p", "(", 
    SubscriptBox["\[Chi]", "eff"]}], TraditionalForm]], "Section",
  FormatType->"TraditionalForm",ExpressionUUID->
  "bba91787-f771-411b-a08c-13489120d049"], "Section"],
 StyleBox[" = 0 | q, \[ScriptCapitalM])", "Section"],
 "\n",
 StyleBox["Maria Okounkova ", "Text"]
}], "Subtitle",
 CellChangeTimes->{{3.840013107155648*^9, 3.840013187194799*^9}, {
  3.840013240309849*^9, 3.8400132768184032`*^9}, {3.84001331234193*^9, 
  3.840013316212626*^9}, {3.840013529910784*^9, 3.840013537548538*^9}, {
  3.840013602856865*^9, 3.84001361356385*^9}, {3.840013688608301*^9, 
  3.840013741244297*^9}, {3.840013993500278*^9, 3.840013993847855*^9}, {
  3.8400140557716913`*^9, 3.840014083719183*^9}, {3.840014122670479*^9, 
  3.8400142807179537`*^9}, {3.84001889746297*^9, 
  3.840018903003881*^9}},ExpressionUUID->"4e27f7b4-7d1d-46a2-b3bb-\
590e76e80625"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Chi]", "eff"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "64b76425-4779-493f-a6cd-a1de770cbdec"],
 " in terms of {q, \[ScriptCapitalM]}"
}], "Subsubsection",
 CellChangeTimes->{{3.8400184461535378`*^9, 3.840018462608673*^9}, {
  3.840018500448777*^9, 
  3.8400185332059097`*^9}},ExpressionUUID->"03e0e2b4-1c22-48eb-a906-\
95f19b1a0371"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solutionm1m2", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m1", "*", "m2"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"3", "/", "5"}], ")"}]}], " ", "/", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m1", " ", "+", " ", "m2"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "5"}], ")"}]}]}], "==", " ", "\[ScriptCapitalM]"}],
      "  ", "&&", "  ", 
     RowBox[{
      RowBox[{"m1", "/", "m2"}], " ", "==", " ", "q"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "m2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.840013107155648*^9, 3.840013187194799*^9}, {
  3.840013240309849*^9, 3.8400132768184032`*^9}, {3.84001331234193*^9, 
  3.840013316212626*^9}, {3.840013529910784*^9, 3.840013537548538*^9}, {
  3.840013602856865*^9, 3.84001361356385*^9}, {3.840013688608301*^9, 
  3.840013741244297*^9}, {3.840013993500278*^9, 3.840013993847855*^9}, {
  3.8400140557716913`*^9, 3.840014083719183*^9}, {3.840014122670479*^9, 
  3.8400141294428988`*^9}, {3.840030086388485*^9, 3.840030087556233*^9}, {
  3.840030572695314*^9, 3.8400305738763523`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4140071b-ea10-4b6a-ae5a-2d1531894dce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m1", "\[Rule]", 
      RowBox[{
       SuperscriptBox["q", 
        RowBox[{"2", "/", "5"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], 
        RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]}], ",", 
     RowBox[{"m2", "\[Rule]", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], 
         RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}], 
       SuperscriptBox["q", 
        RowBox[{"3", "/", "5"}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "5"}]]}], " ", 
       SuperscriptBox["q", 
        RowBox[{"2", "/", "5"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], 
        RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]}], ",", 
     RowBox[{"m2", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"1", "/", "5"}]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}], 
          RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}], 
        SuperscriptBox["q", 
         RowBox[{"3", "/", "5"}]]]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m1", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"2", "/", "5"}]], " ", 
       SuperscriptBox["q", 
        RowBox[{"2", "/", "5"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], 
        RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]}], ",", 
     RowBox[{"m2", "\[Rule]", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "5"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], 
         RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}], 
       SuperscriptBox["q", 
        RowBox[{"3", "/", "5"}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"3", "/", "5"}]]}], " ", 
       SuperscriptBox["q", 
        RowBox[{"2", "/", "5"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], 
        RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]}], ",", 
     RowBox[{"m2", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"3", "/", "5"}]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}], 
          RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}], 
        SuperscriptBox["q", 
         RowBox[{"3", "/", "5"}]]]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m1", "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"4", "/", "5"}]], " ", 
       SuperscriptBox["q", 
        RowBox[{"2", "/", "5"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], 
        RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]}], ",", 
     RowBox[{"m2", "\[Rule]", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"4", "/", "5"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], 
         RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}], 
       SuperscriptBox["q", 
        RowBox[{"3", "/", "5"}]]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8400131882019787`*^9, {3.840013248869824*^9, 3.840013266621748*^9}, 
   3.840013331212618*^9, {3.840013530947847*^9, 3.8400135388590593`*^9}, 
   3.8400136146586847`*^9, {3.840013698895256*^9, 3.840013745397838*^9}, 
   3.840014087086323*^9, 3.840021545071022*^9, 3.840024945093399*^9, 
   3.840030088906201*^9, 3.8400305816026793`*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"fc11a814-6696-4278-a22d-168d2e721bb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Subm1m2", " ", "=", " ", 
  RowBox[{"Solutionm1m2", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.840013516246718*^9, 3.8400135763064957`*^9}, {
  3.840013618689562*^9, 3.840013639744025*^9}, {3.840013725121695*^9, 
  3.8400137474773808`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"867e8eed-5b84-437e-a9df-127622c7ee90"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"m1", "\[Rule]", 
    RowBox[{
     SuperscriptBox["q", 
      RowBox[{"2", "/", "5"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "q"}], ")"}], 
      RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]}], ",", 
   RowBox[{"m2", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "q"}], ")"}], 
       RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}], 
     SuperscriptBox["q", 
      RowBox[{"3", "/", "5"}]]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.840013543563999*^9, 3.840013576842278*^9}, {
   3.840013621444111*^9, 3.840013647968382*^9}, {3.840013731971856*^9, 
   3.840013748779752*^9}, 3.8400215474678583`*^9, 3.840024947767345*^9, 
   3.840030091484983*^9, 3.840030593655333*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"3e01933a-6124-488e-af2e-1c7e9c019d38"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChiEffectivem1m2", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a1", " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], "/", "m1"}], ")"}]}], " ", 
     "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a2", " ", "*", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], ")"}], "/", "m2"}]}], ")"}],
    "/", 
   RowBox[{"(", 
    RowBox[{"m1", " ", "+", " ", "m2"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.840024889983089*^9, 3.840024901729897*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"5e8d11f9-9e74-4534-bf55-9460fcca6a40"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{"a1", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "m1"], "+", 
   FractionBox[
    RowBox[{"a2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "m2"]}], 
  RowBox[{"m1", "+", "m2"}]]], "Output",
 CellChangeTimes->{3.840024951165697*^9, 3.840030097052697*^9, 
  3.840030595711762*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"d09f5fc6-90e6-416e-bed2-2d914e21f48f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChiEffective", " ", "=", 
  RowBox[{
   RowBox[{"ChiEffectivem1m2", " ", "/.", " ", "Subm1m2"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.840013654739626*^9, 3.840013681257902*^9}, {
   3.8400137635920963`*^9, 3.840013833302824*^9}, {3.840014305891704*^9, 
   3.8400143252745047`*^9}, 3.840018353890367*^9, {3.840024905327668*^9, 
   3.8400249082945137`*^9}, {3.840031545418783*^9, 3.840031548411848*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"f8e28027-3e8c-4d6e-9773-f965703314f7"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["q", 
    RowBox[{"1", "/", "5"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a1", " ", 
      RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
     RowBox[{"a2", " ", "q", " ", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "q"}], ")"}], 
    RowBox[{"7", "/", "5"}]], " ", 
   SuperscriptBox["\[ScriptCapitalM]", "2"]}]]], "Output",
 CellChangeTimes->{{3.840013676321129*^9, 3.840013682059186*^9}, {
   3.840013820541656*^9, 3.840013833904969*^9}, 3.8400143293501987`*^9, 
   3.84001835455162*^9, 3.840021549553051*^9, 3.840024954199934*^9, 
   3.8400301029104357`*^9, 3.8400306056125193`*^9, {3.840031549075779*^9, 
   3.840031553841235*^9}},
 CellLabel->"Out[26]=",ExpressionUUID->"458ff559-075b-4b4f-abf8-4b67bba50d19"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prior distributions", "Subsubsection",
 CellChangeTimes->{{3.840018610463304*^9, 
  3.84001861355099*^9}},ExpressionUUID->"933ad47f-2dc5-4f18-bae3-\
d5d9ea0d04af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pa", "[", "a_", "]"}], " ", ":=", " ", 
  "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P\[Theta]", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P\[Phi]", "[", "\[Phi]_", "]"}], " ", ":=", " ", 
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{"2", "*", "Pi"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.840014834096483*^9, 3.840014895975119*^9}, {
  3.840015552318199*^9, 3.840015572078557*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"d534e432-35de-41e3-811b-2ab6d805e074"],

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"Pa", "[", "a", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"a", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8400148579011803`*^9, 3.84001487235987*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"19a74063-eb75-4a84-b013-c598639f591d"],

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"P\[Theta]", "[", "\[Theta]", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", " ", "0", ",", " ", "Pi"}], "}"}]}], "]"}]], \
"Input",
 CellChangeTimes->{{3.8400148992943707`*^9, 3.840014917962408*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"7c307335-8979-4dc3-9038-16399cf69645"],

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"P\[Phi]", "[", "\[Phi]", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", " ", "0", ",", " ", 
     RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.840015577175397*^9, 3.840015591899823*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"9d6bbefc-862f-4411-923a-fd920bb8c555"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PriorProduct", " ", "=", " ", 
  RowBox[{
   RowBox[{"Pa", "[", "a1", "]"}], "*", 
   RowBox[{"Pa", "[", "a2", "]"}], "*", 
   RowBox[{"P\[Theta]", "[", "\[Theta]1", "]"}], "*", 
   RowBox[{"P\[Theta]", "[", "\[Theta]2", "]"}], "*", 
   RowBox[{"P\[Phi]", "[", "\[Phi]1", "]"}], "*", 
   RowBox[{"P\[Phi]", "[", "\[Phi]2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.840015617622923*^9, 3.840015680157583*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"0636d014-1f50-4c53-af46-2047ee374d44"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], 
  RowBox[{"16", " ", 
   SuperscriptBox["\[Pi]", "2"]}]]], "Output",
 CellChangeTimes->{3.840015635883894*^9, 3.84001568134767*^9, 
  3.840021556261644*^9, 3.8400249590836773`*^9, 3.84003010783605*^9, 
  3.840030610712092*^9, 3.84003155908078*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"c772274d-4b9f-4603-bb41-9a20a8103308"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Conditional probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "(", 
    SubscriptBox["\[Chi]", "eff"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "40a8e9b0-091b-40b8-a56d-24620c067a74"],
 " = 0 | ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "1"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "0cae5080-173d-4556-b2db-dc5532b1c949"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b7c98aea-1ed1-4888-955e-482cbf1457b9"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "1"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "383819e8-b0e9-45ee-bb0c-3d1f559ef16c"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1988e420-548e-44e4-98c5-588d49d817db"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Phi]", "1"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "554250ab-af58-4d34-a323-028313c2cb3b"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Phi]", "2"], ",", " ", "q", ",", " ", 
     "\[ScriptCapitalM]"}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "add8fb76-72ad-441c-a6e1-a907aa19578c"]
}], "Subsubsection",
 CellChangeTimes->{{3.8400188757605867`*^9, 
  3.840019016496303*^9}},ExpressionUUID->"7a5c0b8a-45d5-446e-9398-\
b74e03edc4ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PChiEffGivenAllVariables", " ", "=", " ", 
  RowBox[{"DiracDelta", "[", "ChiEffective", "]"}]}]], "Input",
 CellChangeTimes->{{3.8400190207930613`*^9, 3.8400190207947474`*^9}, {
  3.840024965799574*^9, 3.840024966304737*^9}, {3.840029017735238*^9, 
  3.840029018320998*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"27cb08d5-b4ad-4c9c-a3e3-3a3604100842"],

Cell[BoxData[
 RowBox[{"DiracDelta", "[", 
  FractionBox[
   RowBox[{
    SuperscriptBox["q", 
     RowBox[{"1", "/", "5"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"a2", " ", "q", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "q"}], ")"}], 
     RowBox[{"7", "/", "5"}]], " ", 
    SuperscriptBox["\[ScriptCapitalM]", "2"]}]], "]"}]], "Output",
 CellChangeTimes->{3.840019022320485*^9, 3.8400215590116673`*^9, 
  3.840024967127009*^9, 3.8400290190636272`*^9, 3.84003011073663*^9, 
  3.840030615509348*^9, 3.840031561090576*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"01202f13-b60e-414d-bc7a-730ab9397dfc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Integrate to compute the probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "(", 
    RowBox[{
     SubscriptBox["\[Chi]", "eff"], " ", "=", " ", "0"}]}], TraditionalForm]],
  
  FormatType->"TraditionalForm",ExpressionUUID->
  "fb3fdb18-0660-4bc7-9d1d-33d2aa21b230"],
 "| q, \[ScriptCapitalM]) "
}], "Subsubsection",
 CellChangeTimes->{{3.840018655837099*^9, 3.840018721770391*^9}, {
  3.840018814233088*^9, 3.840018815733883*^9}, {3.8400188922300034`*^9, 
  3.8400188931569033`*^9}},ExpressionUUID->"d93d7862-0b79-43c3-b372-\
7dac8f396ab9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrand", " ", "=", " ", 
  RowBox[{
  "PChiEffGivenAllVariables", " ", "*", " ", "PriorProduct"}]}]], "Input",
 CellChangeTimes->{{3.840018792271545*^9, 3.84001879957626*^9}, {
  3.840018858091859*^9, 3.8400188614477262`*^9}, {3.840019068845644*^9, 
  3.840019075778963*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"0906c139-aefb-4033-9665-b00862ae1190"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"DiracDelta", "[", 
    FractionBox[
     RowBox[{
      FractionBox[
       RowBox[{"a1", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], 
       RowBox[{
        SuperscriptBox["q", 
         RowBox[{"2", "/", "5"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], 
         RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]], "+", 
      FractionBox[
       RowBox[{"a2", " ", 
        SuperscriptBox["q", 
         RowBox[{"3", "/", "5"}]], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], 
         RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]]}], 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}], 
         RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}], 
       SuperscriptBox["q", 
        RowBox[{"3", "/", "5"}]]], "+", 
      RowBox[{
       SuperscriptBox["q", 
        RowBox[{"2", "/", "5"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], 
        RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]}]], "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], 
  RowBox[{"16", " ", 
   SuperscriptBox["\[Pi]", "2"]}]]], "Output",
 CellChangeTimes->{3.8400190765372047`*^9, 3.840021565670083*^9, 
  3.840024971709407*^9, 3.840029024420245*^9, 3.840030115030599*^9, 
  3.840030618345937*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"4f624357-ab91-430e-96e4-cfefaa8e9c30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IntegratedOverPhi", " ", "=", " ", 
  RowBox[{"Integrate", "[", 
   RowBox[{"Integrand", ",", " ", 
    RowBox[{"{", 
     RowBox[{"\[Phi]1", ",", " ", "0", ",", " ", 
      RowBox[{"2", "*", "Pi"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"\[Phi]2", ",", " ", "0", ",", " ", 
      RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.840019080704659*^9, 3.840019131937406*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"485bf67a-e5c8-4feb-a933-89f26ce21f9a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"DiracDelta", "[", 
   FractionBox[
    RowBox[{
     FractionBox[
      RowBox[{"a1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], 
      RowBox[{
       SuperscriptBox["q", 
        RowBox[{"2", "/", "5"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], 
        RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]], "+", 
     FractionBox[
      RowBox[{"a2", " ", 
       SuperscriptBox["q", 
        RowBox[{"3", "/", "5"}]], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], 
        RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]]}], 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "q"}], ")"}], 
        RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}], 
      SuperscriptBox["q", 
       RowBox[{"3", "/", "5"}]]], "+", 
     RowBox[{
      SuperscriptBox["q", 
       RowBox[{"2", "/", "5"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "q"}], ")"}], 
       RowBox[{"1", "/", "5"}]], " ", "\[ScriptCapitalM]"}]}]], "]"}], " ", 
  RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
  RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]], "Output",
 CellChangeTimes->{{3.84001911101903*^9, 3.840019132992029*^9}, 
   3.840021571249106*^9, 3.840024991948279*^9, 3.8400290277962103`*^9, 
   3.840030117567383*^9, 3.840030625098085*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"a658a2cc-d72d-495b-be73-151ebe59d8ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IntegratedOverTheta1", " ", "=", " ", 
  RowBox[{"Integrate", "[", 
   RowBox[{"IntegratedOverPhi", ",", " ", 
    RowBox[{"{", 
     RowBox[{"\[Theta]1", ",", " ", "0", ",", " ", "Pi"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.840019199371649*^9, 3.840019205172649*^9}, {
  3.840019249059926*^9, 3.840019274756181*^9}, {3.840019398688322*^9, 
  3.84001940457439*^9}, {3.840021584746769*^9, 3.840021655759852*^9}, {
  3.840021890862718*^9, 3.840021891350225*^9}, {3.840024542158512*^9, 
  3.840024549639553*^9}, {3.840025002203372*^9, 3.840025017871757*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"1ee531a1-002a-4857-921c-e7316e10a83e"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", "a1", " ", 
     SuperscriptBox["q", 
      RowBox[{"1", "/", "5"}]]}]], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "q"}], ")"}], 
     RowBox[{"7", "/", "5"}]], " ", 
    SuperscriptBox["\[ScriptCapitalM]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"HeavisideTheta", "[", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q", 
          RowBox[{"1", "/", "5"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a1"}], "+", 
           RowBox[{"a2", " ", "q", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}], 
          RowBox[{"7", "/", "5"}]], " ", 
         SuperscriptBox["\[ScriptCapitalM]", "2"]}]], "]"}], "-", 
      RowBox[{"HeavisideTheta", "[", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q", 
          RowBox[{"1", "/", "5"}]], " ", 
         RowBox[{"(", 
          RowBox[{"a1", "+", 
           RowBox[{"a2", " ", "q", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "q"}], ")"}], 
          RowBox[{"7", "/", "5"}]], " ", 
         SuperscriptBox["\[ScriptCapitalM]", "2"]}]], "]"}]}], ")"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.840021668343398*^9, 3.840021915450445*^9, 
  3.840024568542284*^9, 3.840025025584433*^9, 3.840029038043879*^9, 
  3.8400301255410767`*^9, 3.8400306375201*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"0139761e-ace4-4c99-b9bb-579df218cc4a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\n",
 StyleBox["Massaging the terms - take what\[CloseCurlyQuote]s not being \
integrated over outside, and remove the terms that don\[CloseCurlyQuote]t \
contribute to the sign of argument of the Heaviside function", "Text"]
}], "Subsubsection",
 CellChangeTimes->{{3.840025543934349*^9, 3.840025608029067*^9}, {
  3.8400291411712103`*^9, 3.840029177261524*^9}, {3.840029270834772*^9, 
  3.840029311444083*^9}},ExpressionUUID->"d6d5876c-944f-4357-bac4-\
7cd233e26dac"],

Cell[BoxData[
 RowBox[{"Coefficient", " ", "=", " ", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     SuperscriptBox["q", 
      RowBox[{"1", "/", "5"}]]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "q"}], ")"}], 
    RowBox[{"7", "/", "5"}]], " ", 
   SuperscriptBox["\[ScriptCapitalM]", "2"], " "}]}]], "Input",
 CellChangeTimes->{{3.840029178665666*^9, 3.840029200278887*^9}, {
  3.840029232462982*^9, 3.840029237702084*^9}, {3.840030135834634*^9, 
  3.840030136275144*^9}, {3.8400306435782146`*^9, 
  3.840030643858736*^9}},ExpressionUUID->"6aa3d170-529d-4e86-84ba-\
a4ca155a38d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SimplifiedIntegrand", " ", "=", " ", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"a1", " "}]]}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"HeavisideTheta", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "a1"}], " ", "+", 
        RowBox[{"a2", "  ", "q", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}], "]"}], "-", 
     RowBox[{"HeavisideTheta", "[", 
      RowBox[{"(", 
       RowBox[{"a1", " ", "+", 
        RowBox[{"a2", " ", "q", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}], "]"}]}], ")"}], 
   " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.840029206823471*^9, 3.840029266828476*^9}, {
  3.840029323972836*^9, 3.840029340449504*^9}, {3.840030149946735*^9, 
  3.8400301589250937`*^9}, {3.8400306509016027`*^9, 3.840030657001545*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"cbed8fe7-db31-41b6-b519-903d2a14daa8"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"HeavisideTheta", "[", 
       RowBox[{
        RowBox[{"-", "a1"}], "+", 
        RowBox[{"a2", " ", "q", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], "]"}], "-", 
      RowBox[{"HeavisideTheta", "[", 
       RowBox[{"a1", "+", 
        RowBox[{"a2", " ", "q", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], "]"}]}], ")"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "a1"]}]], "Output",
 CellChangeTimes->{3.840030292105695*^9, 3.840030660320196*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"f7214ea0-d8f6-45ae-8324-c773e4311b6a"]
}, Open  ]],

Cell[TextData[{
 "Split the integral over ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "2"], " ", "into", " ", "two", " ", "parts", " ",
     "before", " ", "integrating", " ", "over", " ", 
    SubscriptBox["a", "1"], " ", "and", " ", 
    SubscriptBox["a", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7816eebf-131a-48b1-9525-7732b1c0ebf0"]
}], "Text",
 CellChangeTimes->{{3.8400293435859203`*^9, 
  3.840029519145831*^9}},ExpressionUUID->"b4dd66ba-86f1-4d8b-bb5b-\
49da70a812a0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CosThetaPositiveTerm", " ", "=", " ", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"0", " ", "<", " ", "q", " ", "<", " ", "1"}], " ", "&&", " ", 
     RowBox[{"0", " ", "<", " ", "\[Theta]2", " ", "<", " ", 
      RowBox[{"Pi", "/", "2"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"HeavisideTheta", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "a1"}], " ", "q"}], "+", 
             RowBox[{"a2", " ", 
              RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}], "]"}], "-", 
          RowBox[{"HeavisideTheta", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a1", " ", "q"}], "+", 
             RowBox[{"a2", "  ", 
              RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], " ", ")"}], "]"}]}],
          ")"}], 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"a1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"a2", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], "}"}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.840029521688283*^9, 3.840029578036644*^9}, {
  3.840029610706397*^9, 3.84002973388367*^9}, {3.8400297826770477`*^9, 
  3.840029786337014*^9}, {3.840029820343774*^9, 3.840029822045224*^9}, {
  3.840029933457718*^9, 3.840029973313451*^9}, {3.8400300460071898`*^9, 
  3.840030055650695*^9}, {3.840030162171431*^9, 3.840030169726356*^9}, {
  3.840030243357126*^9, 
  3.840030250555668*^9}},ExpressionUUID->"da58947c-f162-470c-ad1e-\
0ab2f28e79b4"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q"}], "+", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"q", "-", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], ")"}], "2"], " ", 
     RowBox[{"HeavisideTheta", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       FractionBox[
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], "q"]}], "]"}], " ", 
     RowBox[{"Tan", "[", "\[Theta]2", "]"}]}]}], 
   RowBox[{"2", " ", "q"}]], "}"}]], "Output",
 CellChangeTimes->{{3.840029666953726*^9, 3.84002969678375*^9}, 
   3.840029792728929*^9, 3.840029845165635*^9, 3.840029996818012*^9, {
   3.840030058110175*^9, 3.8400300631705837`*^9}, 3.840030176957816*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"59da9161-968f-4ce1-889c-85be47fbe491"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CosThetaNegativeTerm", " ", "=", " ", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"0", " ", "<", " ", "q", " ", "<", " ", "1"}], " ", "&&", " ", 
     RowBox[{
      RowBox[{"Pi", "/", "2"}], " ", "<", " ", "\[Theta]2", " ", "<", " ", 
      "Pi"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"HeavisideTheta", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "a1"}], " ", "q"}], "+", 
           RowBox[{"a2", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}], "]"}], "-", 
        RowBox[{"HeavisideTheta", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a1", " ", "q"}], "+", 
           RowBox[{"a2", "  ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], " ", ")"}], "]"}]}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"a1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"a2", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], "}"}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.840029372296927*^9, 3.840029382199744*^9}, 
   3.8400297786173973`*^9, {3.840029826593543*^9, 3.840029853146571*^9}, {
   3.840030188942243*^9, 3.8400302024020042`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"e04b3b24-269c-4619-9a0a-98992fd0edd3"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["q", "2"], "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"q", "+", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], ")"}], "2"], " ", 
       RowBox[{"HeavisideTheta", "[", 
        FractionBox[
         RowBox[{"q", "+", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "q"], "]"}]}]}], ")"}], 
    " ", 
    RowBox[{"Sec", "[", "\[Theta]2", "]"}]}], 
   RowBox[{"2", " ", "q"}]], "}"}]], "Output",
 CellChangeTimes->{3.840029858898926*^9, 3.8400302057165318`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"2e6c90d8-d2de-4b00-9c50-e2005716edf5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CosThetaPosTerm", " ", "=", " ", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"q", " ", ">", " ", "1"}], " ", "&&", " ", 
     RowBox[{"0", " ", "<", " ", "\[Theta]2", " ", "<", " ", 
      RowBox[{"Pi", "/", "2"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Integrate", "[", 
      RowBox[{"SimplifiedIntegrand", ",", " ", 
       RowBox[{"{", 
        RowBox[{"a1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"a2", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], "}"}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.840030257071229*^9, 3.840030272050255*^9}, {
  3.840030674679842*^9, 3.8400306787833767`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"b9fff9f1-103a-4ebf-8131-604983e1efab"],

Cell[BoxData[
 RowBox[{"{", 
  TagBox[GridBox[{
     {"\[Piecewise]", GridBox[{
        {
         FractionBox[
          RowBox[{"Tan", "[", "\[Theta]2", "]"}], "q"], 
         RowBox[{
          RowBox[{"Sec", "[", "\[Theta]2", "]"}], "\[LessEqual]", "q"}]},
        {"0", 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->True]}
       },
       AllowedDimensions->{2, Automatic},
       Editable->True,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}},
       Selectable->True]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.35]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   "Piecewise",
   DeleteWithContents->True,
   Editable->False,
   SelectWithContents->True,
   Selectable->False,
   StripWrapperBoxes->True], "}"}]], "Output",
 CellChangeTimes->{3.8400303228693523`*^9, 3.840030705800806*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"45bbd5cf-554a-455d-92a7-a3dce13b16ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"m", " ", ">", " ", "0"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"HeavisideTheta", "[", 
           RowBox[{
            RowBox[{"-", "x"}], " ", "+", " ", 
            RowBox[{"m", " ", "*", " ", "y"}]}], "]"}], " ", "+", " ", 
          RowBox[{"HeavisideTheta", "[", 
           RowBox[{"x", " ", "+", " ", 
            RowBox[{"m", " ", "*", " ", "y"}]}], "]"}]}], ")"}], "/", "x"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"y", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8400309008130503`*^9, 3.840031000426322*^9}, {
  3.840031040841967*^9, 3.8400310436409063`*^9}, {3.8400310849121313`*^9, 
  3.840031095395794*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"309fd135-4271-4464-a677-7bdd3ec7549f"],

Cell[BoxData[
 TemplateBox[{
  "Integrate", "idiv", 
   "\"Integral of \\!\\(\\*RowBox[{FractionBox[\\\"1\\\", \\\"x\\\"], \\\"-\\\
\", FractionBox[RowBox[{\\\"HeavisideTheta\\\", \\\"[\\\", RowBox[{\\\"1\\\", \
\\\"-\\\", FractionBox[\\\"x\\\", \\\"m\\\"]}], \\\"]\\\"}], \\\"m\\\"], \
\\\"+\\\", FractionBox[RowBox[{\\\"HeavisideTheta\\\", \\\"[\\\", \
RowBox[{\\\"1\\\", \\\"-\\\", FractionBox[\\\"x\\\", \\\"m\\\"]}], \
\\\"]\\\"}], \\\"x\\\"]}]\\) does not converge on \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]\\).\"", 2, 24, 6, 
   23282606015866461486, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.840031090977611*^9, 3.840031097822722*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"6c6f1d9d-a8a1-47b0-838c-37bf3b195daa"],

Cell[BoxData[
 TemplateBox[{
  "Integrate", "idiv", 
   "\"Integral of \\!\\(\\*RowBox[{FractionBox[\\\"1\\\", \\\"x\\\"], \\\"-\\\
\", FractionBox[RowBox[{\\\"HeavisideTheta\\\", \\\"[\\\", RowBox[{\\\"1\\\", \
\\\"-\\\", FractionBox[\\\"x\\\", \\\"m\\\"]}], \\\"]\\\"}], \\\"m\\\"], \
\\\"+\\\", FractionBox[RowBox[{\\\"HeavisideTheta\\\", \\\"[\\\", \
RowBox[{\\\"1\\\", \\\"-\\\", FractionBox[\\\"x\\\", \\\"m\\\"]}], \
\\\"]\\\"}], \\\"x\\\"]}]\\) does not converge on \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]\\).\"", 2, 24, 7, 
   23282606015866461486, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.840031090977611*^9, 3.840031098469057*^9}},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"fd2ed464-1ac8-42c1-a603-46044f746233"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", "1"], 
   RowBox[{
    FractionBox[
     RowBox[{"m", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", "-", "x"}], ")"}], " ", 
       RowBox[{"HeavisideTheta", "[", 
        RowBox[{"1", "-", 
         FractionBox["x", "m"]}], "]"}]}]}], 
     RowBox[{"m", " ", "x"}]], 
    RowBox[{"\[DifferentialD]", "x"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8400309871319532`*^9, 3.840031002677383*^9}, 
   3.840031053657276*^9, {3.840031091466113*^9, 3.840031098474234*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"03df48f2-6139-4a6d-ab1e-468359bcf93f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 897},
WindowMargins->{{5, Automatic}, {Automatic, 48}},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b05cf4db-6007-4787-8793-1cd80719ad58"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 955, 20, 87, "Subtitle",ExpressionUUID->"4e27f7b4-7d1d-46a2-b3bb-590e76e80625"],
Cell[CellGroupData[{
Cell[1560, 46, 425, 11, 45, "Subsubsection",ExpressionUUID->"03e0e2b4-1c22-48eb-a906-95f19b1a0371"],
Cell[CellGroupData[{
Cell[2010, 61, 1311, 30, 52, "Input",ExpressionUUID->"4140071b-ea10-4b6a-ae5a-2d1531894dce"],
Cell[3324, 93, 4611, 140, 245, "Output",ExpressionUUID->"fc11a814-6696-4278-a22d-168d2e721bb0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7972, 238, 374, 7, 30, "Input",ExpressionUUID->"867e8eed-5b84-437e-a9df-127622c7ee90"],
Cell[8349, 247, 919, 24, 57, "Output",ExpressionUUID->"3e01933a-6124-488e-af2e-1c7e9c019d38"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9305, 276, 645, 18, 30, "Input",ExpressionUUID->"5e8d11f9-9e74-4534-bf55-9460fcca6a40"],
Cell[9953, 296, 443, 12, 58, "Output",ExpressionUUID->"d09f5fc6-90e6-416e-bed2-2d914e21f48f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10433, 313, 539, 9, 30, "Input",ExpressionUUID->"f8e28027-3e8c-4d6e-9773-f965703314f7"],
Cell[10975, 324, 873, 22, 57, "Output",ExpressionUUID->"458ff559-075b-4b4f-abf8-4b67bba50d19"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11897, 352, 169, 3, 45, "Subsubsection",ExpressionUUID->"933ad47f-2dc5-4f18-bae3-d5d9ea0d04af"],
Cell[12069, 357, 629, 15, 73, "Input",ExpressionUUID->"d534e432-35de-41e3-811b-2ab6d805e074"],
Cell[12701, 374, 335, 7, 30, "Input",ExpressionUUID->"19a74063-eb75-4a84-b013-c598639f591d"],
Cell[13039, 383, 360, 8, 30, InheritFromParent,ExpressionUUID->"7c307335-8979-4dc3-9038-16399cf69645"],
Cell[13402, 393, 376, 8, 30, InheritFromParent,ExpressionUUID->"9d6bbefc-862f-4411-923a-fd920bb8c555"],
Cell[CellGroupData[{
Cell[13803, 405, 512, 10, 30, "Input",ExpressionUUID->"0636d014-1f50-4c53-af46-2047ee374d44"],
Cell[14318, 417, 460, 10, 53, "Output",ExpressionUUID->"c772274d-4b9f-4603-bb41-9a20a8103308"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14827, 433, 1531, 50, 45, "Subsubsection",ExpressionUUID->"7a5c0b8a-45d5-446e-9398-b74e03edc4ee"],
Cell[CellGroupData[{
Cell[16383, 487, 377, 6, 30, "Input",ExpressionUUID->"27cb08d5-b4ad-4c9c-a3e3-3a3604100842"],
Cell[16763, 495, 797, 21, 57, "Output",ExpressionUUID->"01202f13-b60e-414d-bc7a-730ab9397dfc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17609, 522, 566, 15, 45, "Subsubsection",ExpressionUUID->"d93d7862-0b79-43c3-b372-7dac8f396ab9"],
Cell[CellGroupData[{
Cell[18200, 541, 381, 7, 30, "Input",ExpressionUUID->"0906c139-aefb-4033-9665-b00862ae1190"],
Cell[18584, 550, 1706, 49, 97, "Output",ExpressionUUID->"4f624357-ab91-430e-96e4-cfefaa8e9c30"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20327, 604, 518, 11, 30, "Input",ExpressionUUID->"485bf67a-e5c8-4feb-a933-89f26ce21f9a"],
Cell[20848, 617, 1647, 47, 81, "Output",ExpressionUUID->"a658a2cc-d72d-495b-be73-151ebe59d8ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22532, 669, 675, 12, 30, "Input",ExpressionUUID->"1ee531a1-002a-4857-921c-e7316e10a83e"],
Cell[23210, 683, 1775, 50, 125, "Output",ExpressionUUID->"0139761e-ace4-4c99-b9bb-579df218cc4a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25034, 739, 487, 9, 91, "Subsubsection",ExpressionUUID->"d6d5876c-944f-4357-bac4-7cd233e26dac"],
Cell[25524, 750, 617, 16, 51, "Input",ExpressionUUID->"6aa3d170-529d-4e86-84ba-a4ca155a38d3"],
Cell[CellGroupData[{
Cell[26166, 770, 959, 24, 69, "Input",ExpressionUUID->"cbed8fe7-db31-41b6-b519-903d2a14daa8"],
Cell[27128, 796, 667, 17, 52, "Output",ExpressionUUID->"f7214ea0-d8f6-45ae-8324-c773e4311b6a"]
}, Open  ]],
Cell[27810, 816, 541, 14, 35, "Text",ExpressionUUID->"b4dd66ba-86f1-4d8b-bb5b-49da70a812a0"],
Cell[CellGroupData[{
Cell[28376, 834, 1703, 41, 73, "Input",ExpressionUUID->"da58947c-f162-470c-ad1e-0ab2f28e79b4"],
Cell[30082, 877, 987, 26, 64, "Output",ExpressionUUID->"59da9161-968f-4ce1-889c-85be47fbe491"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31106, 908, 1390, 35, 73, "Input",ExpressionUUID->"e04b3b24-269c-4619-9a0a-98992fd0edd3"],
Cell[32499, 945, 698, 20, 64, "Output",ExpressionUUID->"2e6c90d8-d2de-4b00-9c50-e2005716edf5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33234, 970, 786, 18, 52, "Input",ExpressionUUID->"b9fff9f1-103a-4ebf-8131-604983e1efab"],
Cell[34023, 990, 1528, 43, 61, "Output",ExpressionUUID->"45bbd5cf-554a-455d-92a7-a3dce13b16ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35588, 1038, 1098, 27, 115, "Input",ExpressionUUID->"309fd135-4271-4464-a677-7bdd3ec7549f"],
Cell[36689, 1067, 824, 15, 49, "Message",ExpressionUUID->"6c6f1d9d-a8a1-47b0-838c-37bf3b195daa"],
Cell[37516, 1084, 824, 15, 49, "Message",ExpressionUUID->"fd2ed464-1ac8-42c1-a603-46044f746233"],
Cell[38343, 1101, 646, 17, 58, "Output",ExpressionUUID->"03df48f2-6139-4a6d-ab1e-468359bcf93f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

